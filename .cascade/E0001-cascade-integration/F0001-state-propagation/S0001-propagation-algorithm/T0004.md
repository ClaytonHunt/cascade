---
id: T0004
type: Task
title: Add recursive propagation
status: planned
priority: high
complexity: simple
parent: S0001
created: 2025-01-06
updated: 2025-01-06
---

# Add recursive propagation

## Description

Make propagation recursive so that changes propagate all the way up the hierarchy from Task → Story → Feature → Epic → Project.

## Implementation

```typescript
async function propagateStateChange(childPath: string, registry: Registry): Promise<void> {
  // 1. Load child state
  const childState = await loadState(childPath);

  // 2. Look up parent
  const parentId = lookupParent(registry, childState.id);

  // 3. Stop if no parent (reached root)
  if (!parentId) return;

  // 4. Load parent state
  const parentPath = getStatePath(registry, parentId);
  const parentState = await loadState(parentPath);

  // 5. Update parent state
  const updatedParent = updateParentState(
    parentState,
    childState.id,
    childState.status,
    childState.progress.percentage
  );

  // 6. Write parent state
  await writeState(parentPath, updatedParent);

  // 7. RECURSIVELY propagate to grandparent
  await propagateStateChange(parentPath, registry);
}
```

## Acceptance Criteria

- [ ] Recursively call propagateStateChange on parent
- [ ] Stop at root (parent: null)
- [ ] Handle deep hierarchies (5+ levels)
- [ ] Prevent infinite loops (cycle detection)

## Notes

The recursion naturally stops when it reaches the project root (which has parent: null).
