---
id: F0001
type: Feature
title: State Propagation Engine
status: in-progress
priority: critical
complexity: complex
parent: E0001
created: 2025-01-06
updated: 2025-01-06
---

# State Propagation Engine

## Description

Core engine that watches for state.json changes and automatically propagates updates to parent state files. This is Cascade's primary responsibility in the CARL integration.

## Acceptance Criteria

- [x] StateManager class for reading/writing state.json files
- [ ] Propagation algorithm that updates parent states recursively
- [ ] File watcher that monitors state.json files with debouncing
- [ ] Progress calculation: (completed / total) * 100
- [ ] Error handling for malformed state files
- [ ] Validation to prevent circular dependencies

## Dependencies

- Depends on: RegistryManager (to look up parent IDs)
- Blocks: TreeView updates (needs propagated state data)

## Children

- S0001: Propagation Algorithm Implementation
- S0002: Progress Calculation Logic (planned)
- S0003: File Watcher Integration (planned)

## Execution Strategy

- **Parallel execution possible**: Stories can be developed sequentially
- **Prerequisites**: Registry manager, state manager, test fixtures
- **Estimated effort**: 2 weeks

## Technical Notes

- Uses VSCode FileSystemWatcher API
- Implements 250ms debounce to batch rapid changes
- Recursive algorithm stops at project root (parent: null)
- Handles edge cases: missing state.json, malformed JSON, concurrent updates
